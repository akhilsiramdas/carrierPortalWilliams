<div class="row mb-4">
    <div class="col-12">
        <h1 class="h3 text-dark mb-1">Performance Analytics</h1>
        <p class="text-muted">Track your carrier performance metrics and trends</p>
    </div>
</div>

<!-- Time Period Selector -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body py-2">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="btn-group" role="group">
                            <input type="radio" class="btn-check" name="timePeriod" id="period30" value="30" checked>
                            <label class="btn btn-outline-primary" for="period30">Last 30 Days</label>
                            
                            <input type="radio" class="btn-check" name="timePeriod" id="period90" value="90">
                            <label class="btn btn-outline-primary" for="period90">Last 90 Days</label>
                            
                            <input type="radio" class="btn-check" name="timePeriod" id="period365" value="365">
                            <label class="btn btn-outline-primary" for="period365">Last Year</label>
                        </div>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <button type="button" class="btn btn-outline-info" id="refreshAnalytics">
                            <i class="fas fa-sync-alt me-1"></i>Refresh Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Key Performance Indicators -->
<div class="row mb-4">
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card text-center">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small">On-Time Delivery</span>
                    <i class="fas fa-clock text-success"></i>
                </div>
                <h2 class="text-success mb-0" id="onTimeRate">{{ analytics.performance_30d.on_time_delivery_rate or 85.5 }}%</h2>
                <small class="text-muted">Target: 90%</small>
            </div>
        </div>
    </div>
    
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card text-center">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small">Avg Delay</span>
                    <i class="fas fa-exclamation-triangle text-warning"></i>
                </div>
                <h2 class="text-warning mb-0" id="avgDelay">{{ analytics.performance_30d.average_delay_hours or 2.3 }}h</h2>
                <small class="text-muted">Target: < 2h</small>
            </div>
        </div>
    </div>
    
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card text-center">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small">Total Shipments</span>
                    <i class="fas fa-shipping-fast text-primary"></i>
                </div>
                <h2 class="text-primary mb-0" id="totalShipments">{{ analytics.performance_30d.total_shipments or 156 }}</h2>
                <small class="text-muted">This period</small>
            </div>
        </div>
    </div>
    
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="card text-center">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small">Customer Rating</span>
                    <i class="fas fa-star text-info"></i>
                </div>
                <h2 class="text-info mb-0" id="customerRating">{{ analytics.customer_satisfaction.score or 4.2 }}/5</h2>
                <small class="text-muted">{{ analytics.customer_satisfaction.feedback_count or 47 }} reviews</small>
            </div>
        </div>
    </div>
</div>

<!-- Charts Row -->
<div class="row mb-4">
    <!-- Delivery Performance Trend -->
    <div class="col-lg-8 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Delivery Performance Trend</h5>
            </div>
            <div class="card-body">
                <canvas id="performanceTrendChart" height="100"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Route Efficiency -->
    <div class="col-lg-4 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Route Efficiency</h5>
            </div>
            <div class="card-body text-center">
                <canvas id="routeEfficiencyChart" width="200" height="200"></canvas>
                <h4 class="mt-3 text-success">{{ analytics.route_efficiency.efficiency_score or 88.5 }}%</h4>
                <p class="text-muted">Avg Route Time: {{ analytics.route_efficiency.average_route_time or 4.2 }}h</p>
            </div>
        </div>
    </div>
</div>

<!-- Detailed Analytics -->
<div class="row">
    <!-- Monthly Summary -->
    <div class="col-lg-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Monthly Summary</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>This Month</th>
                                <th>Last Month</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Total Deliveries</td>
                                <td>89</td>
                                <td>76</td>
                                <td><span class="text-success">+17%</span></td>
                            </tr>
                            <tr>
                                <td>On-Time Rate</td>
                                <td>87.5%</td>
                                <td>84.2%</td>
                                <td><span class="text-success">+3.3%</span></td>
                            </tr>
                            <tr>
                                <td>Damage Claims</td>
                                <td>1</td>
                                <td>3</td>
                                <td><span class="text-success">-67%</span></td>
                            </tr>
                            <tr>
                                <td>Avg Rating</td>
                                <td>4.3</td>
                                <td>4.1</td>
                                <td><span class="text-success">+0.2</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Top Performing Routes -->
    <div class="col-lg-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Top Performing Routes</h5>
            </div>
            <div class="card-body">
                <div class="route-item d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                    <div>
                        <h6 class="mb-1">Houston → Dallas</h6>
                        <small class="text-muted">23 deliveries</small>
                    </div>
                    <div class="text-end">
                        <div class="text-success"><strong>96%</strong></div>
                        <small class="text-muted">on-time</small>
                    </div>
                </div>
                
                <div class="route-item d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                    <div>
                        <h6 class="mb-1">Austin → San Antonio</h6>
                        <small class="text-muted">18 deliveries</small>
                    </div>
                    <div class="text-end">
                        <div class="text-success"><strong>94%</strong></div>
                        <small class="text-muted">on-time</small>
                    </div>
                </div>
                
                <div class="route-item d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                    <div>
                        <h6 class="mb-1">Dallas → Fort Worth</h6>
                        <small class="text-muted">15 deliveries</small>
                    </div>
                    <div class="text-end">
                        <div class="text-success"><strong>91%</strong></div>
                        <small class="text-muted">on-time</small>
                    </div>
                </div>